<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labs</title>
    <!-- css style -->
    <link rel="stylesheet" href="ALL-LABS.css">
    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- font awsome library -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <!-- bootstrap icons library -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <!-- google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400..700&family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>

<body style="background-color:rgb(234, 244, 251)">
    <div class=" bg-white p-4 m-5 rounded-4 pe-5 ">
        <div class="content container ">
            <!-- description -->
            <h2 class="copper mt-3"> Stored XSS</h2>
            <br>
            <h5 class="text-dark lead border border-2 border-secondary rounded p-3">The payload is stored on the server (e.g., in a comment) and later delivered to victims, This lab demonstrates a DOM-Based Stored Cross-Site Scripting (XSS) vulnerability. The attacker injects a payload in a comment form, which gets stored and later rendered in the DOM via JavaScript in an unsafe way. Because the browser parses and executes that DOM manipulation, malicious scripts can execute in the victim's browser.</h5>
            <div id="accesslab" class=" btn btn-warning d-block  my-5  p-3 " style="width: 200px; color: var(--main-color);"><i class="fa-solid fa-unlock p-1"></i> Acess the LAB</div>
            
            <button class=" btn btn-primary d-block  my-5  p-3 " style="width: 200px; color: var(--main-color); id="showInputButton" onclick="showInput()">Submit Flag</button>
            
            <div id="submissionContainer">
        <input type="text" id="flagInput" placeholder="Enter Flag" />
        <button class=" btn  d-block  my-5  p-3 " style="width: 100px; color: var(--main-color); " id="SubmitFlag">Submit</button>
    </div>
            
            <button id="terminateBtn" class=" btn btn-danger d-block  my-5  p-3 "  style="width: 200px; color: var(--main-color);">Terminate Lab</button>
            <pre id="result"></pre>
            <div id="labUrlDisplay"></div>
            <!-- the solution accordion-->
            <div class="accordion " id="accordionExample1">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="true" aria-controls="collapseOne">
                            <div> <i class="fa-solid fa-lightbulb fa-bounce" style="color: #cd6d13; width: 15px;"></i>  <span>Solution</span> </div>
                        </button>
                    </h2>
                    <div id="collapse1" class="accordion-collapse collapse " aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <strong class="p-1">
                                Working Payloads (examples):

                                <code> &lt;img src="x" onerror="alert('XSS')"&gt; </code>

                            </strong>
                        </div>
                    </div>
                </div>
            </div>
            <!-- the Hint accordion-->
            <div class="accordion " id="accordionExample2">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingOne">
                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="true" aria-controls="collapseOne">
                            <div> <i class="fa-solid fa-bolt fa-bounce" style="color: #cd6d13; width: 15px;"></i>  <span> Hint</span> </div>
                        </button>
                    </h2>
                    <div id="collapse2" class="accordion-collapse collapse " aria-labelledby="headingOne" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            <strong class="p-1">
                                Non-working Payloads (blocked or neutralized):
                                <code> &lt;script&gt;alert('XSS');&lt;/script&gt; </code>
                                there are filter for &lt;script&gt;
                                <code> &lt;a href="#" onclick="alert('XSS')"&gt; Click me &lt;/a&gt;</code>
                            </strong>


                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="ALL-LABS.js"></script>
    <script src="xss-lab3.js"></script>
</body>
</html>
